---
phase: 07-github-pages-deployment
plan: 01
type: execute
depends_on: []
files_modified: [.github/workflows/deploy.yml]
---

<objective>
Create GitHub Actions workflow for automated 11ty build and GitHub Pages deployment.

Purpose: When commits are pushed to main (either manually or via n8n orchestration), GitHub Actions automatically builds the site and deploys to GitHub Pages.
Output: Working CI/CD pipeline that builds and deploys on every push to main.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-plan.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/06-n8n-workflow-setup/06-03-SUMMARY.md

@package.json
@eleventy.config.js

**Tech stack available:**
- 11ty v3.1.2 (ES module config)
- Node.js with ES modules (type: module in package.json)
- npm scripts: build, dev, clean

**Established patterns:**
- Build output: _site/ directory
- Build command: npm run build (eleventy)
- No test suite (verification is manual)

**Constraining decisions:**
- Phase 6: orchestrate-content.js handles git commit/push to main branch
- n8n pushes commits via orchestration script
- Free tier constraint: GitHub Pages (free hosting)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create GitHub Actions deployment workflow</name>
  <files>.github/workflows/deploy.yml</files>
  <action>
Create GitHub Actions workflow for 11ty build and Pages deployment:

1. Trigger: on push to main branch
2. Jobs:
   - build-and-deploy:
     - runs-on: ubuntu-latest
     - permissions: contents read, pages write, id-token write
     - steps:
       - Checkout repository
       - Setup Node.js (v20, cache npm)
       - Install dependencies (npm ci)
       - Build site (npm run build)
       - Setup Pages
       - Upload artifact (_site directory)
       - Deploy to GitHub Pages

Use the official github-pages-deploy pattern:
- actions/checkout@v4
- actions/setup-node@v4
- actions/configure-pages@v4
- actions/upload-pages-artifact@v3
- actions/deploy-pages@v4

Environment: github-pages with url output

AVOID:
- Third-party deployment actions (use official GitHub Pages actions)
- Environment secrets for deployment (GitHub Pages uses GITHUB_TOKEN automatically)
- Separate build and deploy jobs (single job is simpler and sufficient)
  </action>
  <verify>cat .github/workflows/deploy.yml shows valid YAML with correct structure</verify>
  <done>Workflow file exists with correct triggers, steps, and GitHub Pages deployment configuration</done>
</task>

<task type="auto">
  <name>Task 2: Verify build succeeds locally</name>
  <files>(verification only)</files>
  <action>
Run local build to verify the workflow would succeed:

1. Clean previous build: npm run clean
2. Run production build: npm run build
3. Verify _site/ directory contains expected files:
   - index.html
   - sitemap.xml
   - robots.txt

This confirms the build command works and produces expected output.

AVOID: Attempting to actually trigger GitHub Actions (that requires the workflow to be pushed first)
  </action>
  <verify>npm run build exits 0 and _site/ contains index.html, sitemap.xml, robots.txt</verify>
  <done>Local build succeeds, _site/ directory populated with expected files</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] .github/workflows/deploy.yml exists with valid YAML
- [ ] Workflow triggers on push to main
- [ ] Workflow uses official GitHub Pages actions
- [ ] npm run build succeeds locally
- [ ] _site/ contains index.html, sitemap.xml, robots.txt
</verification>

<success_criteria>

- GitHub Actions workflow file created
- Workflow configured to build 11ty and deploy to Pages
- Local build verification passes
- Ready for repository GitHub Pages settings configuration
</success_criteria>

<output>
After completion, create `.planning/phases/07-github-pages-deployment/07-01-SUMMARY.md`
</output>
