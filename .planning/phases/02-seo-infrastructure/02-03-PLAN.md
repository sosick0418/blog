---
phase: 02-seo-infrastructure
plan: 03
type: execute
depends_on: []
files_modified: [src/_includes/base.njk]
---

<objective>
Add JSON-LD structured data for enhanced search engine understanding and rich snippets.

Purpose: Enable Google and other search engines to display rich results (star ratings, product info) for product review pages. Critical for affiliate content visibility in search results.
Output: JSON-LD structured data blocks in base template, ready for product review schema in Phase 3.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-plan.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@src/_includes/base.njk
@src/_data/site.json

**Tech stack available:**
- 11ty v3.1.2 (ES modules)
- Nunjucks templating
- Korean language (ko_KR locale)

**Constraining decisions:**
- Phase 01-02: Layouts in _includes/, base.njk is main layout
- Phase 02-01 (parallel): Will add OG meta tags to same file - coordinate placement

**Schema.org reference:**
- WebSite: https://schema.org/WebSite
- Article: https://schema.org/Article (for blog posts)
- Product/Review schema will be added in Phase 3
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add WebSite schema to base.njk</name>
  <files>src/_includes/base.njk</files>
  <action>
Add JSON-LD WebSite schema at the end of the <head> section in base.njk.

```html
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": "{{ site.title }}",
  "url": "{{ site.url }}",
  "description": "{{ site.description }}",
  "inLanguage": "{{ site.language }}"
}
</script>
```

Key points:
- Place AFTER all meta tags (canonical link if present)
- Uses site data for all values
- Provides search engines with basic site information
- inLanguage helps with Korean content classification
  </action>
  <verify>npm run build && grep -A 10 "application/ld+json" _site/index.html</verify>
  <done>WebSite JSON-LD schema present in generated HTML</done>
</task>

<task type="auto">
  <name>Task 2: Add conditional Article schema for posts</name>
  <files>src/_includes/base.njk</files>
  <action>
Add a second JSON-LD block for Article schema that only renders for blog posts.
This prepares the template for product review content in Phase 3.

Add after the WebSite schema block:

```html
{% if type == "article" or layout contains "post" %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Article",
  "headline": "{{ title }}",
  "description": "{{ description or site.description }}",
  "datePublished": "{{ page.date | dateToISO }}",
  "dateModified": "{{ page.date | dateToISO }}",
  "author": {
    "@type": "Person",
    "name": "{{ site.author }}"
  },
  "publisher": {
    "@type": "Organization",
    "name": "{{ site.title }}"
  },
  "inLanguage": "{{ site.language }}"
}
</script>
{% endif %}
```

Key points:
- Conditional: only renders if page has type="article" or uses a post layout
- Uses dateToISO filter (added in 02-02 plan)
- Minimal required Article properties per Google guidelines
- Does NOT include Product/Review schema - that's for Phase 3
  </action>
  <verify>npm run build (should succeed, Article schema won't render for index page)</verify>
  <done>Article JSON-LD conditionally available for post pages</done>
</task>

<task type="auto">
  <name>Task 3: Verify structured data with build</name>
  <files>_site/index.html</files>
  <action>
Verify the structured data implementation:

1. Run npm run build
2. Check _site/index.html for WebSite schema
3. Verify JSON is valid (proper escaping, no syntax errors)
4. Verify Korean characters render correctly in JSON

Expected: index.html should have WebSite schema but NOT Article schema (since index is not an article).
  </action>
  <verify>npm run build && grep -c "WebSite" _site/index.html && grep -c "Article" _site/index.html</verify>
  <done>WebSite schema present (count: 1), Article schema absent (count: 0) on index page</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] _site/index.html contains WebSite JSON-LD schema
- [ ] JSON-LD is valid JSON (no syntax errors)
- [ ] Korean text in JSON-LD renders correctly
- [ ] Article schema is conditional (not on homepage)
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- WebSite schema on all pages
- Article schema only on article-type pages
- Valid JSON-LD that Google can parse
- No errors or warnings introduced
- Phase 2 (SEO Infrastructure) complete
</success_criteria>

<output>
After completion, create `.planning/phases/02-seo-infrastructure/02-03-SUMMARY.md`

Include: "Phase 2 complete, ready for Phase 3 (Blog Template System)"
</output>
